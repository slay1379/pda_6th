# 🖥️ AWS EC2 인스턴스 성능 리포트 

| 팀 | 말하는감자(김혜윤, 김태헌) |
|----|--------------------------|

## 📌 목적

Flask 서버에 여러 사용자가 일정 시간 동안 동시에 HTTP 요청을 보내고, 다음 두 가지 관점에서 성능을 비교한다.
![image](https://github.com/user-attachments/assets/20e21a71-fdd2-4532-a78b-800360bd2c39)


▶️ **2가지 목적의 실험 방식으로 진행:**
1. **정확한 요청 횟수 기반 (Loop Count 모드)**  
   - 사용자당 100회씩 요청 → 총 10,000회 요청  
   - 처리량(RPS), 응답시간(Latency), 비용(RPS/$) 비교

2. **지속 부하 기반 (Duration 모드)**  
   - 일정 시간(60초) 동안 지속적으로 요청 발생  
   - 시간 경과에 따른 **메모리 사용량, GC 발생, 응답 지연** 등 리소스 변화 관찰  
   - 장시간 운영이 필요한 서비스에 적합한 인스턴스 판별 목적

### 🧪 실험 대상: m6g.medium → m7g.medium → c7g.medium

---

## 1. 테스트 환경

| 항목             | 설정                                                  |
|------------------|-------------------------------------------------------|
| **AMI**          | Amazon Linux 2 (Arm64) + Flask 2.3 + Python 3.7       |
| **리전 / AZ**     | ap-northeast-2a (서울)                                 |
| **부하 발생기**    | t3.large (같은 AZ) · JMeter 5.6.3                     |
| **부하 시나리오**  | - 사용자 100명 × 100회 요청 = 10,000 req (Loop 모드)<br>- 사용자 100명 × 60초 지속 요청 (Duration 모드) |
| **측정 지표**     평균 / p95 응답시간, 처리량(RPS), 에러율(%), RPS per \$ |

---

## 2. 대상 인스턴스

| Instance       | vCPU | RAM   | $/h (Seoul) |
|---------------|-----:|------:|-----------:|
| m6g.medium     | 1    | 4 GiB | \$0.0385   |
| m7g.medium     | 1    | 4 GiB | \$0.0347   |
| c7g.medium     | 1    | 2 GiB | \$0.0315   |

---

## 3. 결과

| Instance     | Avg (ms) | p95 (ms) | RPS   | Err (%) | RPS / \$   |
|--------------|----------|----------|-------|---------|------------|
| m6g.medium   | 70       | 170      | 1240  | 0.00    | 32,208     |
| m7g.medium   | 51       | 168      | 1466  | 0.00    | 42,301     |
| c7g.medium   | 52       | 208      | 1470  | 0.00    | **46,667** |

### 3‑1 Throughput & 가성비
![rps_combo (1)](https://github.com/user-attachments/assets/914c5b98-b503-41ea-92ef-7cda57a73c1a)


### 3‑2 Latency 분포
![latency_box](https://github.com/user-attachments/assets/718ee76d-a5d1-463b-acb0-3f19f55f99b7)


## 3-3. Duration 모드 개별 실행 결과

600초 동안 각 인스턴스에 대해 100명의 사용자가 지속적으로 요청을 보냈고,  
처리량과 응답 시간을 실시간 로그로 분석했습니다.

---

### 🔹 m6g.medium (IP: 15.165.18.211)

| 구간 | 처리량 | Avg 응답 | Max 응답 |
|------|--------|----------|----------|
| 초반 | 1256.9/s | 75ms | 203ms |
| 중반 | 1284.7/s | 77ms | 91ms |
| 후반 | 1283.6/s | 77ms | 85ms |
| 전체 | 1281.5/s | 77ms | **203ms** |

- ✅ 평균 응답 시간은 전 구간에서 거의 동일 (75~77ms)
- ❗ 최대 응답 시간은 초반부터 200ms대가 반복 발생  
  → GC나 순간적 부하 누적 가능성 있음

---

### 🔹 m7g.medium (IP: 43.203.125.62)

| 구간 | 처리량 | Avg 응답 | Max 응답 |
|------|--------|----------|----------|
| 초반 | 1515.3/s | 62ms | 346ms |
| 중반 | 1565.7/s | 63ms | 74ms |
| 후반 | 1564.6/s | 63ms | 81ms |
| 전체 | 1558.1/s | 63ms | **346ms** |

- ✅ 평균 응답 시간 63ms로 **전 구간 고정**
- ✅ Max 값도 대부분 80ms 이하  
  → 성능이 **시간 경과와 무관하게 안정적**

---

### 🔹 c7g.medium (IP: 3.38.141.96)

| 구간 | 처리량 | Avg 응답 | Max 응답 |
|------|--------|----------|----------|
| 초반 | 1548.7/s | 64ms | 277ms |
| 중반 | 1563.6/s | 63ms | 83ms |
| 후반 | 1567.8/s | 63ms | 82ms |
| 전체 | 1561.4/s | 63ms | **277ms** |

- ✅ 테스트 전체(5분 이상) 동안 평균 응답 63ms 유지
- ✅ Max 값은 초반에만 튀고 이후 **안정적 유지**

---

### ✅ 요약 인사이트

- `m6g.medium`: 평균 응답은 안정적이나, 최대 응답 시간이 반복적으로 높아져  
  **GC나 처리 병목이 지속적으로 발생할 가능성** 존재

- `m7g.medium` & `c7g.medium`:  
  **평균/최대 응답시간 모두 일정**,  
  **시간이 지나도 성능 저하 없이 안정적으로 처리량 유지**

→ 장시간 운영 안정성과 일관성 측면에서는 **m7g / c7g 우위**


---

## 4. 분석

1. **세대 업그레이드 효과**  
   - Graviton-2 (m6g) → Graviton-3 (m7g) 변경 시 평균 응답시간 -27%, 처리량 +18%

2. **컴퓨팅 최적화 인스턴스(c7g)**  
   - 최고 처리량(RPS 1,470), 최고 RPS/$ 성능  
   - 다만 p95 응답지연은 가장 높음 → 실시간성이 중요한 서비스에는 주의 필요

3. **m6g.medium은 가장 저렴하지만 지연이 큼**  
   - 복합 트래픽 처리에는 다소 부족할 수 있음

4. **지속 부하 시 m6g에서 GC 빈도 및 응답시간 증가 관찰됨**  
   - 장시간 운영에선 m7g 또는 c7g가 더 안정적

---

## 5. 결론 & 권장 사항

| 사용 시나리오        | 추천 인스턴스   | 근거                               |
|----------------------|----------------|------------------------------------|
| 기본 API 서버         | **m7g.medium**  | 응답속도, 안정성, 비용 균형 우수         |
| CPU 집중 배치 작업    | c7g.medium     | 최고 처리량, 가성비 1위                  |
| x86 기반 레거시 필요  | m6i.large      | 실험 외 항목. x86 앱 호환 목적 참고용    |
| 비핵심 / 저예산 서비스 | m6g.medium     | 가장 저렴하지만 응답 지연은 다소 큼      |

---

## 6. 테스트 방식 요약

### ✅ 정량 요청 모드 (Loop Count 기반)
- 사용자 수: 100명  
- 각 사용자당 100회 요청  
- 총 10,000회 요청 → 성능 비교에 유리

### ✅ 지속 부하 모드 (Duration 기반)
- 사용자 수: 100명  
- 총 60초(1분) 동안 지속 요청  
- 시간에 따른 메모리 점유율, GC, 응답속도 변화 관찰

---

## 7. JMeter 요청 구성

- **방식**: GET  
- **경로**: `/` (Flask 루트)  
- **서버 주소**: `${host}` (스크립트에서 입력)  
- **포트**: 8080  
- **헤더**
  ```http
  User-Agent: JMeter
  Accept: */*

